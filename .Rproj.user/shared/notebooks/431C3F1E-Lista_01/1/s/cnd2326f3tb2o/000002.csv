"0","tauchen_P = function(grid, rho, sigma, mu) {"
"0","  N = length(grid)"
"0","  delta = (max(grid) - min(grid)) / (N-1)"
"0","  PT = matrix(NA_real_, N, N)"
"0","  for(i in 1:N) {"
"0","    for(j in 1:N) {"
"0","      if(j == 1) {"
"0","        PT[i,j] = pnorm( (grid[1] - (1-rho)*mu - rho*grid[i] + delta/2) / sigma )"
"0","      } else if(j==N) {"
"0","        PT[i,j] = 1 - pnorm( (grid[N] - (1-rho)*mu - rho*grid[i] - delta/2) / sigma )"
"0","      } else {"
"0","        PT[i,j] = "
"0","          pnorm((grid[j] + delta/2 - (1-rho)*mu - rho*grid[i]) / sigma) -"
"0","          pnorm((grid[j] - delta/2 - (1-rho)*mu - rho*grid[i]) / sigma)"
"0","      }"
"0","    }"
"0","  }"
"0","  return(PT)"
"0","}"
"0","PT = tauchen_P(thetaT, rho, sigma, mu)"
"0","round(PT, 4)"
"1","     "
"1","   [,1]"
"1","   [,2]"
"1","   [,3]"
"1","   [,4]"
"1","   [,5]"
"1","   [,6]"
"1","   [,7]"
"1","   [,8]"
"1","   [,9]"
"1","
 [1,]"
"1"," 0.7644"
"1"," 0.2347"
"1"," 0.0009"
"1"," 0.0000"
"1"," 0.0000"
"1"," 0.0000"
"1"," 0.0000"
"1"," 0.0000"
"1"," 0.0000"
"1","
 [2,]"
"1"," 0.0592"
"1"," 0.7405"
"1"," 0.1997"
"1"," 0.0006"
"1"," 0.0000"
"1"," 0.0000"
"1"," 0.0000"
"1"," 0.0000"
"1"," 0.0000"
"1","
 [3,]"
"1"," 0.0001"
"1"," 0.0747"
"1"," 0.7569"
"1"," 0.1679"
"1"," 0.0004"
"1"," 0.0000"
"1"," 0.0000"
"1"," 0.0000"
"1"," 0.0000"
"1","
 [4,]"
"1"," 0.0000"
"1"," 0.0001"
"1"," 0.0931"
"1"," 0.7669"
"1"," 0.1396"
"1"," 0.0002"
"1"," 0.0000"
"1"," 0.0000"
"1"," 0.0000"
"1","
 [5,]"
"1"," 0.0000"
"1"," 0.0000"
"1"," 0.0002"
"1"," 0.1147"
"1"," 0.7702"
"1"," 0.1147"
"1"," 0.0002"
"1"," 0.0000"
"1"," 0.0000"
"1","
 [6,]"
"1"," 0.0000"
"1"," 0.0000"
"1"," 0.0000"
"1"," 0.0002"
"1"," 0.1396"
"1"," 0.7669"
"1"," 0.0931"
"1"," 0.0001"
"1"," 0.0000"
"1","
 [7,]"
"1"," 0.0000"
"1"," 0.0000"
"1"," 0.0000"
"1"," 0.0000"
"1"," 0.0004"
"1"," 0.1679"
"1"," 0.7569"
"1"," 0.0747"
"1"," 0.0001"
"1","
 [8,]"
"1"," 0.0000"
"1"," 0.0000"
"1"," 0.0000"
"1"," 0.0000"
"1"," 0.0000"
"1"," 0.0006"
"1"," 0.1997"
"1"," 0.7405"
"1"," 0.0592"
"1","
 [9,]"
"1"," 0.0000"
"1"," 0.0000"
"1"," 0.0000"
"1"," 0.0000"
"1"," 0.0000"
"1"," 0.0000"
"1"," 0.0009"
"1"," 0.2347"
"1"," 0.7644"
"1","
"
"0","rowSums(PT) # Linhas da matriz devem somar 1."
"1","[1]"
"1"," 1"
"1"," 1"
"1"," 1"
"1"," 1"
"1"," 1"
"1"," 1"
"1"," 1"
"1"," 1"
"1"," 1"
"1","
"
